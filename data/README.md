## Папка `data` — тестовые и рабочие данные проекта InvestCalc

Папка `data` содержит **файлы данных**, используемые сервисом InvestCalc:

- для расчётов,
- для сценарного анализа,
- для тестирования,
- для демонстрации различных типов информационных систем (CRM, ERP, HelpDesk, e-commerce и т.д.).

Она включает:

1. **рабочее хранилище сценариев (`scenarios.json`)**  
2. **образцы сценариев (`samples/*.json`)**  
3. **входные данные для различных предметных областей (`input-*.json`)**  
4. **негативные тестовые наборы (`negative-scenarios.json`)**

---

## 1. Основной файл хранилища сценариев

## `scenarios.json`

Это **основной рабочий файл**, в котором сохраняются сценарии, создаваемые пользователем.

Формат: JSON-массив объектов `ScenarioDetail`.

Пример структуры:

```json
[
  {
    "id": "uuid",
    "name": "CRM Local",
    "description": "...",
    "input": { ... },
    "last_result": { ... }
  }
]
```

> При обновлении сценариев сервис автоматически пересчитывает `last_result`.

---

## 2. Папка `samples/` — демонстрационные сценарии

Содержит заранее подготовленные сценарии для примеров и тестирования.

## Файлы:

* `scenario1.json` — пример локального CRM-внедрения
* `scenario2.json` — пример SaaS CRM

Используются для:

* ручного тестирования API
* демонстраций
* генерации документации
* сравнения сценариев

---

## 3. Входные данные для различных информационных систем (`input-*.json`)

Это валидные структуры `InvestInput`, которые можно отправлять прямо в эндпоинт:

```
POST /api/v1/calc
```

## Файлы включают:

* `input-local.json` — локальная CRM
* `input-cloud.json` — SaaS CRM
* `input-hrm.json` — HRM / кадровый учет
* `input-helpdesk.json` — HelpDesk / ITSM
* `input-erp.json` — ERP-система
* `input-ecommerce.json` — e-commerce платформа

Каждый файл содержит:

* CAPEX
* OPEX
* Effects
* Period
* DiscountRate (null)

Это используется для:

* тестирования
* демонстраций в Swagger
* сценарного анализа
* подготовки учебных материалов

---

## 4. `negative-scenarios.json` — негативные тестовые данные

Файл содержит **набор ошибочных и повреждённых сценариев**, используемых для:

* тестирования валидации
* проверки устойчивости парсера
* обработки ошибок API
* regression-тестов

Примеры ошибок:

* отрицательные значения (CAPEX < 0)
* неверные типы (`effects: "string"`)
* отсутствие ключевых полей (`input` отсутствует)
* сломанная структура `last_result`

---

## 5. Как используется папка `data` в проекте

Файлы из этой папки:

* автоматически читаются сервисом `ScenarioService`
* используются в автотестах (`tests/`)
* подключаются в документации (`test-data.md`)
* лежат в volume при Docker-развертывании
* служат источником данных для демонстрации API

В `settings.py` путь задаётся так:

```python
DATA_DIR = Path(__file__).resolve().parent.parent / "data"
SCENARIOS_FILE = DATA_DIR / "scenarios.json"
```

---

## 6. Рекомендации по работе с папкой

* Не изменяйте структуру `scenarios.json` вручную.
* Для наполнения используйте API или копии из `/samples`.
* В продакшн версии храните `scenarios.json` как volume.
* Для тестов используйте `negative-scenarios.json`.
* Для демонстрации — `input-*.json`.

---

## Связанные документы

* `docs/06-implementation/data-access.md`
* `docs/06-implementation/validation.md`
* `docs/07-TESTING/test-data.md`
* `docs/08-devops/backup-restore.md`

 