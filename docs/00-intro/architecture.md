# Архитектура системы InvestCalc (краткое описание)

Документ представляет укрупнённое архитектурное описание InvestCalc, достаточное для понимания структуры системы без погружения в детали реализации.

Полные архитектурные материалы см. в разделе `03-architecture/`.

---

## 1. Общая архитектурная идея

InvestCalc — это лёгкая сервис-ориентированная система, реализованная в виде:

- **Backend-сервиса на FastAPI** (Python 3.12),
- предоставляющего REST API для расчётов экономической эффективности внедрения ИС.

Система не использует тяжёлую инфраструктуру, ориентирована на:
- простоту развёртывания,
- лёгкость обучения,
- возможность использования в учебных проектах,
- перспективу контейнеризации и CI/CD.

---

## 2. Основные подсистемы

Система состоит из следующих логических блоков:

### 2.1. API-слой (FastAPI)
Отвечает за:
- приём входных данных в формате JSON,
- маршрутизацию запросов,
- сериализацию/валидацию через Pydantic,
- формирование ответов.

Файлы:
- `src/api/v1/routes_invest.py`
- `src/main.py`

Эндпоинты:
- `/api/v1/calculate`
- `/api/v1/sensitivity`

---

### 2.2. Сервисный слой (Business Logic)
Содержит бизнес-логику расчётов:
- вычисление TCO,
- вычисление ROI,
- расчёт срока окупаемости,
- анализ чувствительности.

Файл:
- `src/services/invest_service.py`

Особенности:
- полностью независим от API,
- может использоваться в тестах и в других сервисах,
- легко расширяемый.

---

### 2.3. Модели данных (Pydantic)
Содержат определения входных и выходных структур:

- модели запроса (CAPEX, OPEX, эффекты, период),
- модели ответа (TCO, ROI, Payback, интерпретации),
- параметры анализа чувствительности.

Файл:
- `src/models/invest.py`

---

### 2.4. Конфигурационный модуль
Используется для управления настройками сервиса:
- режим Debug,
- переменные окружения,
- параметры системы.

Файл:
- `src/core/config.py`

---

## 3. Высокоуровневая архитектура (упрощённая схема)

+----------------------------+
| Клиент / UI |
| (веб-приложение, Postman) |
+-------------+-------------+
|
v
+----------------------------+
| FastAPI API |
| - маршруты |
| - запрос/ответ JSON |
+-------------+-------------+
|
v
+----------------------------+
| Сервисный слой |
| Логика расчётов: |
| - TCO |
| - ROI |
| - Payback |
| - Sensitivity |
+-------------+-------------+
|
v
+----------------------------+
| Модели данных |
| (Pydantic schemas) |
+----------------------------+


---

## 4. Архитектурные ограничения

Система проектируется как:
- **односервисное приложение** (single-service),
- **stateless API** — не хранит состояние,
- **без БД** на базовой версии,
- с возможностью:
  - подключения PostgreSQL в будущих версиях,
  - расширения функциональности (формирование PDF, отчёты),
  - вынесения в микросервисную архитектуру.

---

## 5. Принципы проектирования

### 5.1. Простота и минимализм
Архитектура должна быть понятной студентам и начинающим аналитикам.

### 5.2. Разделение ответственности (SoC)
- API — только маршрутизация,
- сервис — только логика,
- модели — только данные.

### 5.3. Расширяемость
Система может быть дополнена:
- модулями отчётности,
- модулем БД,
- дополнительными видами расчётов.

### 5.4. Тестируемость
Архитектура построена так, что каждый слой можно тестировать отдельно:
- API-тесты,
- тесты бизнес-логики,
- тесты моделей.

---

## 6. Интеграционные возможности

Система предоставляет внешним сервисам:
- REST API,
- возможность передавать JSON-данные,
- возможность получать набор результатов для визуализации.

Типичные интеграции:
- учебный портал,
- мини-CRM,
- фронтенд на React/Vue,
- микросервисы в учебных проектах.

---

## 7. Связь с документацией

Полные архитектурные документы расположены в каталоге:

docs/03-architecture/

Сюда входят:
- C4-диаграммы,
- ADR,
- подробное архитектурное описание,
- схемы компонентов,
- схемы связей.

 