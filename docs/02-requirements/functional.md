## Функциональные требования к информационной системе «InvestCalc — Инвестиционный аналитик ИС»

Документ определяет полный набор функциональных возможностей системы, необходимых для реализации учебного проекта InvestCalc.

---

## 1. Общие положения

Система InvestCalc представляет собой REST API-сервис, выполняющий вычисления экономических показателей, используемых при оценке эффективности внедрения информационных систем (ИС).

Функциональные требования определяют:
- доступные функции сервиса,
- входные и выходные данные,
- условия выполнения расчётов,
- требования к валидации.

---

## 2. Функциональные требования по модулям

## 2.1. Модуль ввода исходных данных

## ФТ-1. Ввод CAPEX
Пользователь должен иметь возможность передать значение капитальных затрат (CAPEX).  
**Ограничения:**  
- CAPEX ≥ 0  
- принимается как число с плавающей точкой

## ФТ-2. Ввод OPEX
Пользователь должен иметь возможность передать годовые операционные расходы (OPEX).  
**Ограничения:**  
- OPEX ≥ 0

## ФТ-3. Ввод периода анализа
Пользователь должен задавать период анализа в годах.  
**Ограничения:**  
- период ≥ 1 год  
- целое число

## ФТ-4. Ввод экономического эффекта
Пользователь должен задавать годовой экономический эффект.  
**Ограничения:**  
- эффект ≥ 0

## ФТ-5. Загрузка данных из файлов
Система должна поддерживать загрузку готовых сценариев:  
- `input-local.json`  
- `input-cloud.json`

---

## 2.2. Модуль расчёта экономической эффективности

## ФТ-6. Расчёт TCO
Система должна вычислять полную стоимость владения:  
**TCO = CAPEX + (OPEX × период анализа)**

## ФТ-7. Расчёт ROI
Система должна вычислять рентабельность инвестиций:  
**ROI = (Эффекты × период − TCO) / TCO**

## ФТ-8. Расчёт срока окупаемости
Система должна определять срок окупаемости:  
**Payback Period = CAPEX / (Эффект – OPEX)**  
Если `Эффект ≤ OPEX`, система должна вернуть статус «проект не окупается».

## ФТ-9. Передача результата
Система должна отдавать:
- входные данные,
- рассчитанные показатели,
- интерпретации результатов (если необходимо).

---

## 2.3. Модуль анализа чувствительности

## ФТ-10. Генерация вариаций параметров
Система должна генерировать вариации для параметров CAPEX и OPEX:
- 80% (−20%),
- 100% (базовое),
- 120% (+20%).

## ФТ-11. Расчёт по каждой вариации
Для каждой пары значений CAPEX и OPEX система должна:
- рассчитать TCO, ROI и Payback Period,
- вернуть результаты в виде массива объектов.

## ФТ-12. Отображение результатов анализа чувствительности
Результаты должны быть представлены в виде:
- таблицы (при формировании отчёта),
- JSON (при работе через API).

---

## 2.4. Модуль сценариев

## ФТ-13. Поддержка сценария «локальной инфраструктуры»
Система должна уметь выполнять расчёты по `input-local.json`.

## ФТ-14. Поддержка сценария «облачной инфраструктуры»
Система должна уметь выполнять расчёты по `input-cloud.json`.

## ФТ-15. Сравнение сценариев
Система должна предоставлять механизм сравнения:
- TCO локального vs облачного сценариев,
- ROI,
- Payback.

---

## 2.5. Модуль отчётности

## ФТ-16. Формирование HTML-отчёта
Система должна формировать:
- HTML-документ с отображением всех расчётов.

## ФТ-17. Формирование PDF-отчёта (опционально)
Если установлены зависимости, система должна уметь формировать PDF-отчёт.

## ФТ-18. Структура отчёта
Отчёт должен содержать:
- входные данные,
- результаты расчётов,
- анализ чувствительности,
- сравнительный анализ (если выбран),
- выводы и рекомендации.

---

## 2.6. REST API

## ФТ-19. Эндпоинт `/api/v1/calculate`
Должен принимать JSON-объект со входными данными и возвращать результаты расчёта.

## ФТ-20. Эндпоинт `/api/v1/sensitivity`
Должен принимать входные данные и возвращать массив результатов анализа чувствительности.

## ФТ-21. Документация API
Система должна использовать:
- Swagger UI,
- Redoc.

## ФТ-22. Формат данных
Весь обмен данными должен быть в формате JSON.

---

## 2.7. Валидация данных

## ФТ-23. Проверка корректности CAPEX/OPEX
При вводе отрицательных значений система должна возвращать ошибку валидации.

## ФТ-24. Проверка периода
Если период меньше 1 года — ошибка.

## ФТ-25. Проверка окупаемости
Если эффект ≤ OPEX:
- расчёт проводится,
- но Payback обозначается как отсутствующий,
- система возвращает пометку «проект не окупается».

---

## 2.8. Логирование (минимальный уровень)

## ФТ-26. Логирование ошибок
Система должна логировать:
- ошибки входных данных,
- некорректные запросы.

## ФТ-27. Логирование успешных запросов (опционально)
Сервис может логировать успешные операции в DevOps-режиме.

---

## 3. Диаграмма «Функции-Сущности» (ссылка)

Полная диаграмма находится в файле:  
`docs/03-architecture/c4-component.md`

