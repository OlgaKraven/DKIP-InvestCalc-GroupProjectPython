# ADR-09 — Выбор стратегии CI/CD (GitHub Actions)

Дата: 2025-01-01  
Статус: Принято

---

## 1. Контекст

Проект InvestCalc создаётся как:
- учебная информационная система,
- командный проект,
- полностью размещённый на GitHub.

Требуется обеспечить:
- автоматическую проверку кода,
- запуск тестов,
- сборку Docker-образа,
- проверку структуры проекта,
- единое окружение для всех студентов,
- проверку pull request’ов.

GitHub уже используется как основная платформа проекта.

Необходимо выбрать технологию CI/CD.

---

## 2. Решение

Принято решение:

## ✔ Использовать **GitHub Actions**  
как единую платформу для CI/CD InvestCalc.

Рабочий процесс размещён в:

```

devops/.github/workflows/build.yml

```

---

## 3. Обоснование

## 3.1. GitHub Actions — нативная часть GitHub
- интегрируется без дополнительной установки,
- работает внутри экосистемы GitHub,
- автоматизирует PR, Commits, Releases.

## 3.2. Бесплатно для учебных проектов
GitHub предоставляет бесплатные минуты для публичных репозиториев.

## 3.3. Простая конфигурация
Pipeline задаётся в одном YAML-файле:

- установка Python,
- установка зависимостей,
- запуск pytest,
- сборка Docker-образа,
- публикация артефактов (опционально).

## 3.4. Идеально подходит для InvestCalc
Так как проект небольшой, автоматизация не требует:
- Jenkins,
- GitLab CI,
- TeamCity.

## 3.5. Учебная ценность
Студенты могут изучить:
- CI/CD,
- YAML,
- автоматическое тестирование,
- DevOps-практики.

## 3.6. Поддержка Docker
GitHub Actions может:
- собирать Docker-образы,
- публиковать на GitHub Container Registry,
- запускать контейнеры.

---

## 4. Альтернативы

## 4.1. GitLab CI
**Отклонено**  
Причины:
- проект расположен на GitHub,
- студентам придётся работать на двух платформах,
- GitHub Actions проще.

## 4.2. Jenkins
**Отклонено**  
Причины:
- требует сервер,
- тяжёл для учебного проекта,
- сложнее настроить.

## 4.3. Travis CI
**Отклонено**
Причины:
- устарел,
- ограниченные возможности,
- слабая интеграция с Docker.

## 4.4. CircleCI
**Отклонено**
Причины:
- сложнее для студентов,
- ограниченный бесплатный план.

---

## 5. Последствия

## Положительные:
- автоматический запуск тестов,
- быстрый feedback в Pull Request,
- единая стандартизация кода для команды,
- гарантия, что проект собирается у всех,
- прозрачный pipeline,
- возможность расширить CI/CD в будущем.

## Негативные:
- требует написания YAML,
- тесты должны быть корректными (иначе PR отклоняется),
- pipeline может быть медленным при плохом интернете.

---

## 6. Пример конфига GitHub Actions

Файл: `devops/.github/workflows/build.yml`

```yaml
name: InvestCalc CI

on:
  push:
    branches: [ "main", "develop" ]
  pull_request:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: "3.12"

    - name: Install dependencies
      run: |
        pip install -r requirements.txt

    - name: Run tests
      run: |
        pytest -q

    - name: Build Docker image
      run: |
        docker build -t investcalc:latest .
```

---

## 7. Связанные ADR

* ADR-01 — Технологический стек
* ADR-02 — Стратегия развёртывания
* ADR-03 — Структура каталогов
* ADR-05 — Слой бизнес-логики
* ADR-12 — Масштабирование и контейнеризация
 